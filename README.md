# dns-proxy-server
Простой DNS-прокси-сервер с функцией черного списка доменов для фильтрации нежелательных имен хостов

## Описание
Этот проект представляет собой DNS-прокси-сервер, написанный на C для работы под Linux. Сервер поддерживает фильтрацию доменов на основе черного списка, что позволяет блокировать нежелательные доменные имена.

## Установка и запуск

1. Склонируйте репозиторий:
```bash
git clone https://github.com/DromanX/dns-proxy-server.git
```
2. Перейдите в папку с исходным кодом:
```bash
cd dns-proxy-server/
```
3. Выполните makefile:
```bash
make
```
4. Перейдите в папку bin:
```bash
cd bin/
```
5. Запустите сервер:
```bash
./server
```
Сервер работает на порту 5454 используя IP-адрес 0.0.0.0. 

## Настройка
Перед запуском сервера настройте файл конфигурации dns_proxy.conf (при необходимости), который находится в папке config. Файл конфигурации имеет следующие поля:

**dns_server_ip** - сюда прописывается айпи-адрес вышестоящего сервера куда будут перенаправляться DNS-запросы. Мой вышестоящий сервер (wifi-маршрутизатор) имеет ip-адрес 192.168.1.1 - соответвтующий IP указан в данном поле;

**blacklist** - через запятую прописываются нужные домены для черного списка;

**blacklist_response_type** - здесь указывается тип ответа для доменов в чёрном списке, на выбор: NOT_FOUND, REFUSED, FIXED_IP; 

**fixed_ip** - в случае выбора типа ответа FIXED_IP в предыдущем поле необходимо указать ip-адрес который будет возвращаться вместо адреса запрашиваемого домена в чёрном списке.

Также необходимо убедиться чтобы в системе была включена политика пересылки пакетов:
```bash
sudo sysctl -w net.ipv4.ip_forward=1
```
## Тестирование и проверка работы
Сервер был протестирован в терминале на следующих системах:Linux Mint и Ubuntu Server. Для проверки работоспособности сервера можно использовать любой инструмент для запросов доменных имен, указывая порт 5454 и IP-адрес по умолчанию 0.0.0.0. Например:
```bash
nslookup -port=5454 example.com 0.0.0.0
dig @0.0.0.0 -p 5454 example.com
host -p 5454 example.com 0.0.0.0
```
Для правильного завершения работы сервера необходимо нажать комбинацию клавиш **Ctrl+C** во вкладке работы сервера. При успешном завершении сервер выдаст сообщение *"Завершение работы DNS-proxy-сервера..."*

